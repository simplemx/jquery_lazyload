(function(b,a){var c=b(a);b.fn.lazyload=function(d){var g=this;var h;var e=function(j){i()};var f={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:a,data_attribute:"original",skip_invisible:true,appear:null,load:null};function i(){var j=0;if(g.length<1&&h){h.unbind(f.event,e);c.unbind("resize",e)}g=b.grep(g,function(l,k){var m=b(l);if(f.skip_invisible&&!m.is(":visible")){return false}if(b.abovethetop(l,f)||b.leftofbegin(l,f)){return true}else{if(!b.belowthefold(l,f)&&!b.rightoffold(l,f)){m.trigger("appear")}else{if(++j>f.failure_limit){return true}}}return false})}if(d){if(undefined!==d.failurelimit){d.failure_limit=d.failurelimit;delete d.failurelimit}if(undefined!==d.effectspeed){d.effect_speed=d.effectspeed;delete d.effectspeed}b.extend(f,d)}h=(f.container===undefined||f.container===a)?c:b(f.container);if(0===f.event.indexOf("scroll")){h.bind(f.event,e)}this.each(function(){var j=this;var k=b(j);j.loaded=false;k.one("appear",function(){if(!this.loaded){if(f.appear){var l=g.length;f.appear.call(j,l,f)}b("<img />").bind("load",function(){k.hide().attr("src",k.data(f.data_attribute))[f.effect](f.effect_speed);j.loaded=true;var m=b.grep(g,function(o){return !o.loaded});g=b(m);if(f.load){var n=g.length;f.load.call(j,n,f)}}).attr("src",k.data(f.data_attribute))}});if(0!==f.event.indexOf("scroll")){k.bind(f.event,function(l){if(!j.loaded){k.trigger("appear")}})}});c.bind("resize",e);g.sort(function(k,j){var m=b.belowthefold(k,f);var o=b.rightoffold(k,f);var l=b.belowthefold(j,f);var n=b.rightoffold(j,f);if(!m&&!o&&!l&&!n){return 0}else{if(!m&&!o&&(l||n)){return -1}else{if(!l&&!n&&(m||o)){return 1}else{return 0}}}});i();return this};b.belowthefold=function(e,f){var d;if(f.container===undefined||f.container===a){d=c.height()+c.scrollTop()}else{d=b(f.container).offset().top+b(f.container).height()}return d<=b(e).offset().top-f.threshold};b.rightoffold=function(e,f){var d;if(f.container===undefined||f.container===a){d=c.width()+c.scrollLeft()}else{d=b(f.container).offset().left+b(f.container).width()}return d<=b(e).offset().left-f.threshold};b.abovethetop=function(e,f){var d;if(f.container===undefined||f.container===a){d=c.scrollTop()}else{d=b(f.container).offset().top}return d>=b(e).offset().top+f.threshold+b(e).height()};b.leftofbegin=function(e,f){var d;if(f.container===undefined||f.container===a){d=c.scrollLeft()}else{d=b(f.container).offset().left}return d>=b(e).offset().left+f.threshold+b(e).width()};b.inviewport=function(d,e){return !b.rightofscreen(d,e)&&!b.leftofscreen(d,e)&&!b.belowthefold(d,e)&&!b.abovethetop(d,e)};b.extend(b.expr[":"],{"below-the-fold":function(d){return b.belowthefold(d,{threshold:0})},"above-the-top":function(d){return !b.belowthefold(d,{threshold:0})},"right-of-screen":function(d){return b.rightoffold(d,{threshold:0})},"left-of-screen":function(d){return !b.rightoffold(d,{threshold:0})},"in-viewport":function(d){return !b.inviewport(d,{threshold:0})},"above-the-fold":function(d){return !b.belowthefold(d,{threshold:0})},"right-of-fold":function(d){return b.rightoffold(d,{threshold:0})},"left-of-fold":function(d){return !b.rightoffold(d,{threshold:0})}})})(jQuery,window);